
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Defensive Forecasting - Que-sais je?</title>
  <meta name="author" content="yhli">

  
  <meta name="description" content="Defensive forecasting is an approach to designing competitive on-line learning algorithms. The ideas was partially motivated by the game-theoretic &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://yenhuanli.github.io/blog/2017/04/12/super-martingale">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Que-sais je?" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-77006714-1', 'auto');
    ga('send', 'pageview');

  </script>



</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Que-sais je?</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="https://www.google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="yenhuanli.github.io" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Defensive Forecasting</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-12T18:37:39+02:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>6:37 pm</span></time>
        
        
      </p>
    
  </header>


<div class="entry-content"><p><em>Defensive forecasting</em> is an approach to designing competitive on-line learning algorithms. 
The ideas was partially motivated by the game-theoretic framework of probability theory.
Although it seems that finally, defensive forecasting can be formulated without stating game-theoretic probability as in <a href="https://doi.org/10.1016/j.tcs.2010.04.003">this paper</a>, I find it insightful to understand the original formulation.</p>

<h3 id="game-theoretic-probability">Game-Theoretic Probability</h3>

<p>To get some idea about what the game-theoretic framework is, let us review an interesting result in this framework. 
Consider the following probabiilty prediction game. 
Let $K_0 = 1$.
For every $n \in \mathbb{N}$,</p>

<ol>
  <li><em>Forecaster</em> announces $p_n \in [ 0, 1 ]$.</li>
  <li><em>Skeptic</em> announces $s_n \in \mathbb{R}$.</li>
  <li><em>Reality</em> announces $y_n \in \lbrace 0, 1 \rbrace$.</li>
  <li>$K_n = K_{n - 1} + s_n ( y_n - p_n )$.</li>
</ol>

<p>This is in fact a game of betting from the perspective of Skeptic: 
Initially Skeptic has $1$ dollar. 
If $s_n &gt; 0$, Skeptic is betting on the event $y_n = 1$; Skeptic gets $s_n y_n$ dollars in return if the event happens, and loses $s_n p_n$ dollars otherwise. 
Similarly, if $s_n &lt; 0$, Skeptic is betting against the event $y_n = 1$.</p>

<p>The sequence $(K_n)$ is called a <em>martingale</em>.
If $K_0 = 1$ and $K_n \geq 0$ for all $n$, the sequence $( K_n )$ is called a <em>scoring martingale</em>.</p>

<p>Of course, the values of $K_n$ depend on the strategy of Skeptic.
Roughly speaking, in the game-theoretic framework, an event of small probabiilty corresponds to a large value of $K_n$.</p>

<p><strong>Theorem.</strong>
(Weak law of large numbers) 
For any $N \in \mathbb{N}$, there exists a scoring martingale $( K_n )$, such that for any $\delta &gt; 0$, $K_N \geq 1 / \delta$ unless</p>

<script type="math/tex; mode=display">\left\vert \frac{\sum_{n = 1}^N ( y_n - p_n )}{N} \right\vert \leq \frac{1}{\sqrt{ \delta N }}.</script>

<p><em>Proof.</em> Choose</p>

<script type="math/tex; mode=display">s_n = \frac{2 \sum_{n = 1}^{n - 1} ( y_n - p_n )}{N}.</script>

<p><em>Q.E.D.</em></p>

<h3 id="defensive-forecasting">Defensive Forecasting</h3>

<p>Defensive forecasting aims at finding a strategy for Forecaster, such that Skeptic’s capital does not grow, no matter what Reality’s strategy is.</p>

<p>If Skeptic and Reality cooperate, this aim is in general impossible.
For example, Skeptic and Reality can choose $s_n$ and $y_n$ in the following way:</p>

<ul>
  <li>If $p_n &lt; 1 / 2$, they choose $s_n = 2$ and $y_n = 1$.</li>
  <li>If $p_n \geq 1 / 2$, they choose $s_n = -2$ and $y_n = 0$.</li>
</ul>

<p>Then $K_n \geq K_{n - 1} + 1$ for every $n$.</p>

<p>However, if we slightly weaken Skeptic, this aim becomes surprisingly easy.
Notice that Skeptic keeps his wealth growing, by setting $s_n$ as a discontinuous function of $p_n$.
Let us impose a restriction that $s_n$ must be a continuous function of $p_n$.
Then we arrive at the following defensive porecasting protocol.</p>

<p>Let $K_0 = 1$.
For every $n \in \mathbb{N}$,</p>

<ol>
  <li><em>Skeptic</em> announces a continuous function $s_n: [ 0, 1 ] \to \mathbb{R}$.</li>
  <li><em>Forecaster</em> announces $p_n \in [ 0, 1 ]$.</li>
  <li>Reality announces $y_n \in \lbrace 0, 1 \rbrace$.</li>
  <li>$K_n = K_{n - 1} + s_n ( p_n ) ( y_n - p_n )$.</li>
</ol>

<p><strong>Theorem.</strong> 
There always exists a strategy for Forecaster, such that $K_0 \geq K_1 \geq K_2 \geq \cdots$.</p>

<p><strong><em>Proof.</em></strong>
If $s_n$ is strictly positive on $[ 0, 1 ]$, choose $p_n = 1$. 
If $s_n$ is strictly negative on $[ 0, 1 ]$, choose $p_n = 0$.
Otherwise, by continuity of $s_n$, there must exist some $p^\star$ such that $s_n ( p^\star ) = 0$; choose $p_n = p^\star$.
<em>Q.E.D.</em></p>

<h3 id="k29">K29</h3>

<p>K29 is an algorithm for probability prediction, based on the defensive forecasting approach.
Consider the following protocol. 
For $n = 1, 2, \ldots, N$,</p>

<ol>
  <li>Forecaster announces $p_n \in [ 0, 1 ]$.</li>
  <li>Reality announces $y_n \in \lbrace 0, 1 \rbrace$.</li>
</ol>

<p>One can associate $y_n = 1$ to a rainy day; then $p_n$ dentoes Forecaster’s estimate of the probability that a rainy day will happend.</p>

<p>Let $\kappa$ be a kernel on $[ 0, 1 ]$.
The aim of K29 is to guarantee, for all $p \in [ 0, 1 ]$,</p>

<script type="math/tex; mode=display">\left\vert \sum_{n = 1}^N \kappa ( p_n, p ) ( y_n - p_n ) \right\vert \leq \sqrt{N} .</script>

<p>This inequality, roughly speaking, guarantees that the forecasting strategy is <em>calibrated</em>, i.e., for any $p \in [ 0, 1 ]$, among those days with $p_n \approx p$, there are about $( 100 \times p ) \%$ of them that are actually rainy. 
A precise intrepretation of the inequality is in fact much more complicated (for example, it is known that it is impossible to have a deterministic calibrated forecasting algorithm), and hence skipped due to my lazziness ;)
Please find the references for details.</p>

<p><strong>Theorem.</strong>
Assume $\kappa ( p, p ) \leq 1$ for all $p \in [ 0, 1 ]$.
The inequality above can be achieved, if Forecaster applies the defensive forecasting strategy with respect to</p>

<script type="math/tex; mode=display">s_n: p \mapsto \sum_{i = 1}^n \kappa ( p, p_i ) ( y_i - p_i ) .</script>

<p>The resulting forecasting algorithm is called K29, because it is related to a paper of Kolmogorov published in 1929.</p>

<h3 id="references">References</h3>

<ol>
  <li>G. Shafer and S. Ring, “Predicting bond yields using defensive forecasting,” 2010.</li>
  <li>V. Vovk, “Predictions as statements and decisions,” 2006.</li>
  <li>V. Vovk, A. Takemura, and G. Shafer, “Defensive forecasting,” 2005.</li>
</ol>
</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    yhli
  
  </span></span>


      




<time class='entry-date' datetime='2017-04-12T18:37:39+02:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>6:37 pm</span></time>
      
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://yenhuanli.github.io/blog/2017/04/12/super-martingale/" data-via="" data-counturl="http://yenhuanli.github.io/blog/2017/04/12/super-martingale/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2017/03/19/hedge/" title="Previous Post: Hedge Algorithm (1/2)">&laquo; Hedge Algorithm (1/2)</a>
      
      
    </p>
  </footer>
</article>


</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - yhli -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  










  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
